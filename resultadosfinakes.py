import pandas as pd
import re

# Cargar los archivos
df_wos = pd.read_excel('C:\\Users\\CYBERWORD\\Downloads\\data\\universidadespublicasprivadasfinalesl.xlsx')
#df_wos['affiliation_modified'] = df_wos['affiliation'].str.upper()

# Función para verificar si un texto contiene ciertas palabras

def contains_words(substring, text, delimiter=','):
    text = str(text)  # Convertir el valor a cadena de texto
    for part in text.split(delimiter):
        # Verificar si la "parte" comienza con la subcadena
        if part.strip().lower().startswith(substring.lower()):
            return True
    return False
# Palabras clave para buscar
words_to_searchfinal = [

('JATUN YACHAY WASI','ECUADOR'),
('UNIV INVEST TECNOL EXPT','ECUADOR'),
('UNIV INVEST YACHAY TECH','ECUADOR'),
('UNIV YACHAY YECH','ECUADOR'),
('YACHAY EP YACHAY TECH UNIV','ECUADOR'),
('YACHAY SCI COMP GRP','ECUADOR'),
('YACHAY TECH ECUADOR','ECUADOR'),
('YACHAY TECH SCH CHEM CHEM ENGN YACHAY CITY KNOW','ECUADOR'),
('YACHAY TECH URCUQUI ECUADOR','ECUADOR'),
('YACHAY UNIV EXPT TECHNOL RES','ECUADOR'),
('YAEHAY TECH','ECUADOR'),
('YACHAY TECH','ECUADOR'),
('YACHAY TECH UNIV','ECUADOR'),
('YACHAY CITY KNOWLEDGE','ECUADOR'),
('UNIV AMBATO','ECUADOR'),
('ACAD UNIV TECN AMBATO','ECUADOR'),
('DIBESAU UNIV TECN AMBATO','ECUADOR'),
('UNIV TECN AMABATO','ECUADOR'),
('UNIV TECNI AMBATO','ECUADOR'),
('UNIV TECN AMBATO CARRERA INGN MECAN','ECUADOR'),
('UNIV TECN ARRIBATO','ECUADOR'),        
('UNIVERSIDAD TECNICA DE AMBATO','ECUADOR'),           
('UNIV ESTATE AMAZONICA','ECUADOR'),
('UNIV ESTATAL AMAZ','ECUADOR'),
('UNIV ESTATAL AMAZOM','ECUADOR'),
('UNIV ESTATAL AMAZON','ECUADOR'),
('UNIV ESTATAL AMAZON PUYO','ECUADOR'),
('UNIV ESTATAL AMAZONIA','ECUADOR'),
('UNIV ESTATAL AMAZONIC','ECUADOR'),
('UNIV ESTATAL AMAZONICA UEA','ECUADOR'),
('UNIV ESTATAL AMAZONICA UNIV GOVT','ECUADOR'),
('UNIV ESTATAL AMZON','ECUADOR'),
('UNIV ESTATAL AMAZONICA','ECUADOR'),
('UNIV ESTATE AMAZONICA','ECUADOR'),
('UNIV ESTATAL AMAZONICA','ECUADOR'),

('PENINSULA DE SANTA ELENA STATE UNIV','ECUADOR'),
('UNIV ESTATAL PENINSULA SANTA ELENA','ECUADOR'),
('UNIV ESTATAL PENINSULA SANTA ELENA UPSE','ECUADOR'),
('ESCUELA POLITECNICA SUPERIOR DEL EJERCITO','ECUADOR'),
('UNIV FUERZAS ARMADAS ESPE','ECUADOR'),
('UNIV LAS FUERZAS ARMADAS ESPE','ECUADOR'),
('FUERZAS ARMADAS UNIV ESPE','ECUADOR'),
('ESCUELA SUPER POLITECN EJERCITO','ECUADOR'),
('UNIV ESPE ARMED FORCES','ECUADOR'),
('ESPE ECUADOR','ECUADOR'),
('ESPE DCC','ECUADOR'),
('ESPE ECUADOR','ECUADOR'),
('ESPE SENESCYT','ECUADOR'),
('ESPE UNIV','ECUADOR'),
('UFA ESPE','ECUADOR'),
('UNIV ARMED FORCES','ECUADOR'),
('UNIV ARMY FORCES ESPE','ECUADOR'),
('UNIV FUERZA ARMADAS','ECUADOR'),
('UNIV FUERZAS','ECUADOR'),
('UNIV FUERZAS AMADAS','ECUADOR'),
('UNIV FUERZAS ARMADAS DECEM ESPE','ECUADOR'),
('UNIV FUERZAS ARMADAS ESPE','ECUADOR'),
('UNIV FUERZAS ARMADAS ESPE QUITO','ECUADOR'),
('UNIV FUERZAS ARMADAS ESPE SANGOLQUI','ECUADOR'),
('UNIV FUERZAS ARMADAS ESPE SANTO DOMINGO	','ECUADOR'),
('UNIV FUERZAS ARMADAS ESPE SEDE LATACUNGA','ECUADOR'),
('UNIV FUERZAS ARMADAS ESPE UFA ESFORSE','ECUADOR'),
('UNIV FUERZAS ARMADAS FSPE','ECUADOR'),
('UNIV FUERZAS ARRNADAS ESPE','ECUADOR'),
('UNIV FUERZUS ARMADAS ESPE','ECUADOR'),
('UNIV FUES ARMADAS ESPE','ECUADOR'),
('UNIV FUEZAS ARMADA','ECUADOR'),	
('UNIVE FUERZAS ARMADAS ESPE','ECUADOR'),

('ESPOL POLYTECH UNIV','ECUADOR'),
('UNIV POLITECN ESPOL','ECUADOR'),
('ESPOL ESCUELA SUPER POLITECN LITORAL','ECUADOR'),
('ESCUELA POLITECN LITORAL ESPOL','ECUADOR'),
('ESPOL UNIV','ECUADOR'),
('ESCUELA SUPERIOR POLITECNICA DEL LITORAL','ECUADOR'),
('ESCUELA POLITECN SUPER LITORAL ESPOL','ECUADOR'),
('ESCUELA SUPER POLITEC LITORAL ESPOL','ECUADOR'),
('ESPAE ESCUELA NEGOCIOS ESPOL','ECUADOR'),
('ESCUELA SUPER POLITECN LITORA ESPOL','ECUADOR'),
('ESCUELA SUPER POLITECN LITORAI ESPOL','ECUADOR'),
('ESEUELA SUPER POLITECN LITORAL','ECUADOR'),
('ESCUELA SUPER POLITECN LITORAL ECUADOR','ECUADOR'),
('ESCUELA SUPER POLITECN LITORAL ESPOL KM','ECUADOR'),
('ESCUELA SUPER POLITECNICA LITORAL ESPOL','ECUADOR'),
('ESCUELA SUPER POLITICN LITORAL','ECUADOR'),
('ESCUELA SUPER POLITICN LITORAL','ECUADOR'),
('ESCUELA SUPER POLITECN LITORAL FIMCBOR ESPOL','ECUADOR'),
('SUPER POLYTECH SCH COAST ESPOL','ECUADOR'),
('ESCUELA SUPERIO POLITECN LITORAL','ECUADOR'),
('HIGHER POLYTECH COLL LITTORAL CIBE ESPOL','ECUADOR'),
('HIGHER POLYTECH SCH COASTLINE ESPOL','ECUADOR'),
('HIGHER POLYTECH SCH LITORAL','ECUADOR'),
('LITORAL POLYTECH UNIV','ECUADOR'),
('UNIV ESCUELA POLITECN LITORAL','ECUADOR'),	
('BIOTECHNOL RES CTR ECUADOR CIBE ESPOL','ECUADOR'),
('CONTROL IND UNIV POLYTECHN ESPOL','ECUADOR'),
('LITTORAL POLYTECH SUPER SCH ESPOL','ECUADOR'),
('LITTORAL POLYTECH UNIV ESPOL','ECUADOR'),
('POLYTECH UNIV ESPOL','ECUADOR'),	
('UNIV ESPOL','ECUADOR'),
('ESPOL POLYTECH UNIV','ECUADOR'),	
('UNIV POLITECN ESPOL','ECUADOR'),

('ESPOL CDF JOINT RES PROGRAM','ECUADOR'),
('ESPOL ESPAE','ECUADOR'),
('FIMCP ESPOL','ECUADOR'),
('POLITECN LITORAL','ECUADOR'),
('POLYTECH SCH LITORAL','ECUADOR'),
('E SUPER POLITECN LITORAL GUAYAQUIL','ECUADOR'),
('EPN','ECUADOR'),
('ESCUELA POLITECNICA NACIONAL ECUADOR','ECUADOR'),
('ESCUELA POLITECN NACL EPN','ECUADOR'),
('ESCUELA POLITCN NACL EPN','ECUADOR'),
('ESCUELA POLITECN NACL CEC EPN','ECUADOR'),
('EPN QUITO','ECUADOR'),
('CTR EDUC CONTINUA EPN','ECUADOR'),
('ESCUELA POHTECN NACL','ECUADOR'),
('ESCUELA POLIECN NACL','ECUADOR'),
('ESCUELA POLITCN NACL EPN','ECUADOR'),
('ESCUELA POLITEC NACL','ECUADOR'),
('ESCUELA POLITECN MENK NACL','ECUADOR'),
('ESCUELA POLITECN NAC','ECUADOR'),
('ESCUELA POLITECN NACL CEC EPN','ECUADOR'),
('ESCUELA POLITECN NACL CIENCIAS COMPUTAC','ECUADOR'),
('ESCUELA POLITECN NACL ECUADOR','ECUADOR'),
('ESCUELA POLITECN NACL ECUADOR EPN','ECUADOR'),
('ESCUELA POLITECN NACL EGRESADO','ECUADOR'),
('ESCUELA POLITECN NACL IG EPN','ECUADOR'),
('ESCUELA POLITECN NACL IGEPN','ECUADOR'),
('ESCUELA POLITECN NACL LADRON GUEVARA E11','ECUADOR'),
('ESCUELA POLITECN NACL MEPN','ECUADOR'),
('ESCUELA POLOTECN NACL','ECUADOR'),
('IG EPN','ECUADOR'),
('UNIV POLITECN NACL EPN','ECUADOR'),
('NATL POLYTECH SCH EPN','ECUADOR'),
('NATL POLYTECH SCH QUIT','ECUADOR'),
('UNIV POLITECN NACL EPN','ECUADOR'),
('FAC LATINOAMER CIENCIAS SOCIALES FLACSO ECUADOR','ECUADOR'),
('ESTUDIOS INT FLACSO ECUADOR','ECUADOR'),
('ESTUDIOS URBANOS FLACSO ECUADOR','ECUADOR'),	
('FAC CIENCIAS SOCI FLACSO','ECUADOR'),
('FAC CIENCIAS SOCIALES FLACSO','ECUADOR'),
('FAC CIENCIAS SOCIALES FLACSO SEDE QUITO','ECUADOR'),	
('FAC LATINAMER CIENCIAS SOCIALES FLACSO','ECUADOR'),
('FAC LATINOAMER CIENCIA SOCIALES FLACSO','ECUADOR'),	
('FLACSO BIBLIOTECA','ECUADOR'),
('FLACSO ECUADOR','ECUADOR'),
('FLACSO ECUADOR PROGRAMA ECON','ECUADOR'),
('FLACSO EQUADOR','ECUADOR'),
('FLACSO FAC LATINOAMER CIENCIAS SOCIALES SEDE ECUA','ECUADOR'),
('LATIN AMER FAC SOCIAL SCI ECUADOR FLACSO ECUADOR','ECUADOR'),
('LATIN AMER SCH SOCIAL SCI FLACSO','ECUADOR'),	
('FAC LATINOAMER CIENCIA SOCIALES FLACSO','ECUADOR'),
('FAC LATINAMER CIENCIAS SOCIALES FLACSO','ECUADOR'),

('FAC LATINOAMER CIENCIAS SOCI','ECUADOR'),
('FAC LATINOAMER CIENCIAS SOCI ECUADOR','ECUADOR'),
('FAC LATINOAMER CIENCIAS SOCIALES ECUADOR FLACSO','ECUADOR'),
('FAC LATINOAMER CIENCIAS SOCIALES ECUADOR FLACSO','ECUADOR'),
('FAC LATINOAMER CIENCIAS SOCIALES FLACSO EQUADOR','ECUADOR'),
('FAC LATINOAMER CIENCIAS SOCIALES FLACSO QUITO','ECUADOR'),
('FAC LATINOAMER CIENCIAS SOCIALES FLASCO','ECUADOR'),
('FAC LATINOAMER CIENCIAS SOCIALS FLACSO ECUADOR DE','ECUADOR'),
('FAC LATINOAMERICANA CIENCIAS ECUADOR','ECUADOR'),
('FAC LATINOAMERICANA CIENCIAS SOCI FLACSO','ECUADOR'),
('FAC LATINOAMERICANA CIENCIAS SOCIALES FLACSO','ECUADOR'),
('FAC LATIONOAMER CIENCIAS SOCIALES FLACSO ECUADOR','ECUADOR'),	
#revisaar
('FLACSO SEDE ECUADOR','ECUADOR'),
('LATIN AMER FAC SOCIAL SCI FLACSO','ECUADOR'),
('FLACSO FAC LATINOAMER CIENCIAS SOCIALES','ECUADOR'),
('FAC LATINOAMER CIENCIAS SOCI FLACSO','ECUADOR'),
('FLACSO QUITO','ECUADOR'),
('LATIN AMER SOCIAL SCI INST FLACSO','ECUADOR'),
('CITE FLACSO','ECUADOR'),
('DEPT ANTROPOL HIST HUMANIDADES FLACSO','ECUADOR'),
('DEPT ESTUDIOS POLIT FLACSO ECUADOR FLACSO ECUADOR','ECUADOR'),
('UASB UDLA','ECUADOR'),
#--

('SIMON BOLIVAR ANDEAN UNIV','ECUADOR'),
('UNIV ANDINA SIM BOLIVAR','ECUADOR'),
('UNIV ANDINA SIMON BOLIVAR','ECUADOR'),
('UNIV ANDINA SIMON BOLIVAR UASB','ECUADOR'),
('UNIV ANDINA SIMON BOLVAR SEDE ECUADOR','ECUADOR'),
('UNIV ANDINA SIMON BOLIVAR SEDE ECUADOR','ECUADOR'),
('UNIV ANDINA SIMON BOLIVAR ECUADOR','ECUADOR'),
('UNIV ANDINA SIMON BOLIVAR QUITO','ECUADOR'),
('UNIV ANDINA SIMON','ECUADOR'),
('UASB ECUADOR','ECUADOR'),
('UASB SEDE ECUADOR','ECUADOR'),
('UNIV AGRARIA ECUADOR','ECUADOR'),
('AGRARIAN UNIV ECUADOR','ECUADOR'),
('PROMETEO SENESCYT UNIV AGRARIA ECUADOR UAE','ECUADOR'),
('UNIV TECN ESTATAL LUIS VARGAS TORRES UTELVT ESMER','ECUADOR'),
('UNIV TECN ESMERALDAS','ECUADOR'),
('UNIV TECN LUIS VARGAS TORRES ESMERALDAS','ECUADOR'),
('UNIV TECN ESMERALDAS LUIS VARGAS TORRES','ECUADOR'),
('UNIV TECN LUIS VARGAS TORRES ESMERALDAS','ECUADOR'),
('UNIV LUIS VARGAS TORRES ESMERALDAS','ECUADOR'),
('UNIV TEC LUIS VARGAS TORRES ESMERALDAS','ECUADOR'),
('UNIV TECN LUIS VATGAS TORRES ESMERALDA','ECUADOR'),

('UNIV TECN ESMERALDAS','ECUADOR'),

('UNIV TECN ESTATAL LUIS VARGAS TORRES UTELVT ESMER','ECUADOR'),
('UNIV ESMERALDAS','ECUADOR'),
('UNIV REG AMAZONICA IKIAM','ECUADOR'),
('UNIV REG AMAZONICA','ECUADOR'),
('IKIAM UNIV REG AMAZON','ECUADOR'),
('IKIAM AMAZON REG UNIV','ECUADOR'),
('UNIV REG AMAZEN IKIAM','ECUADOR'),
('UNIV REG AMAZON IKIAM PARROQUIA MUYUNA','ECUADOR'),
('AMAZON REG UNIV IKIAM','ECUADOR'),
('IKIAM UNIV','ECUADOR'),
('UNIV AMAZON IKIAM','ECUADOR'),
('UNIV REG AMAZON IKIAM','ECUADOR'),
('UNIV REG AMAZN IKIAM','ECUADOR'),
('UNIV REG AMAZON ECUADOR','ECUADOR'),
('UNIV REG AMAZON IKIAM TENA','ECUADOR'),
('UNIV REG AMAZON ILKIAM','ECUADOR'),
('UNIV REG AMAZON LKIAM','ECUADOR'),
('UNIV REG AMAZONICS IKIAM','ECUADOR'),
('UNIV REG AMOZON','ECUADOR'),
('UNIV REG AMZON IKIAM','ECUADOR'),
('UNIV REG ARNAZON IKIAM','ECUADOR'),
('UNIV REG AMAZONICA IKIAM','ECUADOR'),	
('IKIAM UNIV REG AMAZON','ECUADOR'),
('IKIAM AMAZON REG UNIV','ECUADOR'),	
('UNIV REG AMAZEN IKIAM','ECUADOR'),
('UNIV REG AMAZON IKIAM PARROQUIA MUYUNA','ECUADOR'),	
('AMAZON REG UNIV IKIAM','ECUADOR'),
('ESPAM','ECUADOR'),
('ESPAM MFL','ECUADOR'),
('UNIV ESCUELA SUPER POLITECN AGR MANABI MANUEL FEL','ECUADOR'),
('ESCUELA SUPER POLITECN AGR MANABI ESPAM MFL','ECUADOR'),
('ESCUELA SUPER POLITECN MANABI ESPAM MFL','ECUADOR'),
('ESCUELA SUPER POLITECN AGR MANABI ESPAMMFL','ECUADOR'),
('ESCUELA SUPER POLITECN AGR MANABI ESPA MFL','ECUADOR'),
('ESCUELA SUPER POLITECN AGR MANABI ESPAMMFL','ECUADOR'),
('ESCUELA SUPER POLITECN AGR MANABI MANUE FELIX LOP','ECUADOR'),
('ESCUELA SUPER POLITECN AGR MANABI MANUEL','ECUADOR'),
('ESCUELA SUPER POLITECN AGR MANABI MANUEL FELIZ','ECUADOR'),
('ESCUELA SUPER POLITECN AGROPECUARIA MANABI','ECUADOR'),
('ESCUELA SUPER POLITECN AGROPECUARIA MANABI MANUEL','ECUADOR'),	
('ESCUELA SUPER POLITECN MANABI ESPAM','ECUADOR'),
('ESCUELA SUPER POLITECN MANABI','ECUADOR'),
('ESCUELA SUPER POLITECN MANABI ESPAM','ECUADOR'),	
('ESPAM FML','ECUADOR'),
('ESPAM MFL CICEM','ECUADOR'),
('CENT UNIV ECUADOR UCE','ECUADOR'),
('ECUADOR CENT UNIV UCE','ECUADOR'),
('CIUDADELA UNIV UCE CALLE','ECUADOR'),
('FCA UCE','ECUADOR'),
('UNIVERSIDAD CENTRAL DEL ECUADOR','ECUADOR'),
('UNIV ESTATAL SUR MANABI','ECUADOR'),
('UNIV ESTATAL SUR MANABI UNESUM','ECUADOR'),
('UNIV ESTATAL MANABI','ECUADOR'),
('UNIV ESTATAL SUR MANABI','ECUADOR'),
('UNIV SUR MANABI','ECUADOR'),
('ACTUALMENTE UNIV ESTATAL SUR MANABI','ECUADOR'),
('UNIV ESTATAL MANABI UNESUM','ECUADOR'),
('UNIV ESTATAL SUL MANABI','ECUADOR'),
('UNIV ESTATAL SUR','ECUADOR'),
('UNIV ESTATAL SUR DE MANABI','ECUADOR'),
('UNIV ESTATAL SURR MANABI UNESUM','ECUADOR'),
('UNIV MANABI','ECUADOR'),
('SOUTHERN STATE UNIV MANABI','ECUADOR'),
('STATE UNIV SOUTHERN MANABI','ECUADOR'),
('STATE UNIV SOUTH MANABI','ECUADOR'),	
('UNIV SOUTH MANABI UNESUM','ECUADOR'),
('UNIVERSIDAD ESTATAL SUR MANABI','ECUADOR'),
('UNIV ESTATAL SUR MANABI','ECUADOR'),
('UNIVERSIDAD LAICA ELOY ALFARO DE MANABI','ECUADOR'),
('LAY UNIV ELOY ALFARO MANABI','ECUADOR'),
('UNIV LAICA ELOY ALFARO MANABI EXTENS EL CARMEN','ECUADOR'),
('UNIV LAICA ELOY ALFARO ULEAM','ECUADOR'),
('UNIV ELOY ALFARO DE MANABI','ECUADOR'),
('UNIV ELOY ALFARO DE MANTA','ECUADOR'),
('UNIV LAICA ELOY ALFARO DE MANABI','ECUADOR'),
('UNIV LAICA ELOY ALFARO DE MANABI ECUADOR','ECUADOR'),
('UNIV LAICA ELOY ALFARO DE MANABI EXTENS CHONE','ECUADOR'),
('UNIV LAICA ELOY ALFARO DE MANABI MANTA','ECUADOR'),
('UNIV LAICA ELOY ALFARO DE MANTA','ECUADOR'),
('UNIV LAICA ELOY ALFARO MANABI CIUDAD MANTA','ECUADOR'),
('UNIV LAICA ELOY ALFARO MANABI ECUADOR','ECUADOR'),
('UNIV LAICA ELOY ALFARO ULEAM MANABI','ECUADOR'),
('UNIV LAICA ELOY ALFARODE MANABI','ECUADOR'),
('UNIV LAICA ELOY ALFAROOF MANABI','ECUADOR'),
('UNIV LACIA ELOY ALFARO MANABI','ECUADOR'),
('UNIV LAIA ELOY ALFARO MANABI','ECUADOR'),
('UNIV LAIC ELOY ALFARO MANABI','ECUADOR'),
('UNIV LAICA BOY ALFARO MANABI','ECUADOR'),
('UNIV LAICA ELOY','ECUADOR'),
('CIVIL UNIV ELOY ALFARO MANABI','ECUADOR'),
('ELOY ALFARO MANABI SECULAR UNIV','ECUADOR'),
('ELOY ALFARO MANABI UNIV','ECUADOR'),

('GRAD UNIV LAICA ELOY ALFARO MANABI','ECUADOR'),    
('LAICA ELOY ALFARO DE MANABI UNIV','ECUADOR'),
('LAICA ELOY ALFARO UNIV MANABI','ECUADOR'),
('SECULAR UNIV ELOY ALFARO MANABI','ECUADOR'),
('MANABI TECH UNIV UTM','ECUADOR'),
('MANABIS TECH UNIV','ECUADOR'),
('TECH MANABI UNIV','ECUADOR'),
('TECH UNIV MANABI UTE','ECUADOR'),
('UNIV T ECN MANABI','ECUADOR'),
('UNIVERSIDAD TECNICA DE MANABI','ECUADOR'),
('UNIV TECN MANABI','ECUADOR'),
('UNIV TECN MANABI CHONE','ECUADOR'),
('UNIV TECN MANABI EXTENS BAHIA DE CARAQUEZ','ECUADOR'),
('UNIV TECN MANABI PORTOVIEJO','ECUADOR'),
('UNIV TECNICA MANABI','ECUADOR'),
('SENESCYT NATL UNIV LOJA','ECUADOR'),
('NACL UNIV LOJA','ECUADOR'),
('UNIV NACL LOJA','ECUADOR'),
('UNIV NACL LOJA UNL','ECUADOR'),
('UNI NACL LOJA','ECUADOR'),
('UNIV NACL DE LOJA','ECUADOR'),
('UNIV NACL LOJA ECUADOR','ECUADOR'),
('UNIV NACL LOLA','ECUADOR'),
('UNIV LOJA UTPL','ECUADOR'),
('FAFI UTB','ECUADOR'),
('UTB','ECUADOR'),
('UNIV TECN BABAHOYO','ECUADOR'),
('TECH UNIV BABAHOYO','ECUADOR'),
('UNIV BABAHOYO','ECUADOR'),
('UNIV ESTATAL BABAHOYO','ECUADOR'),
('UNIV TECN BABAHOYO CURRICULO','ECUADOR'),
('ADMIS UNIV TECN BABAHOYO','ECUADOR'),
('UNIV TECN BABAHOYO EXTENS QUEVEDO','ECUADOR'),
('QUEVEDO STATE TECH UNIV','ECUADOR'),
('UNIV TECN ESTATAL QUEVEDO','ECUADOR'),
('TECH STATE UNIV QUEVEDO','ECUADOR'),
('TECH UNIV QUEVEDO UTEQ','ECUADOR'),
('UNIV ESTATAL QUEVEDO','ECUADOR'),
('UNIV TECN ESTATAL QUEVEDO UTEQ','ECUADOR'),
('QUEVEDO STATE TECH UNIV UTEQ','ECUADOR'),
('UNIV ESTATAL QUEVEDO UTEQ','ECUADOR'),
('UNIV CIENICAS ESTATAL QUEVEDO','ECUADOR'),
('STATE TECH UNIV','ECUADOR'),
('UNIV TECNA ESTATAL QUEVEDO','ECUADOR'),
('UNIV TECN ESTATEDE QUEVEDO','ECUADOR'),
('UNIV TECN ESTATAL QUEVEDO','ECUADOR'),
('UNIV TECN ESTATAL QUEBEDO','ECUADOR'),
('UNIV TECN ESTATE QUEVEDO','ECUADOR'),
('UNIV TECN QUEVEDO','ECUADOR'),
('TECH UNIV QUEVEDO','ECUADOR'),
('UNIV TECN EESTATAL QUEVEDO','ECUADOR'),
('UNIV TECH ESTATAL QUEVEDO','ECUADOR'),
('UNIV MONICA ESTATAL QUEVEDO','ECUADOR'),
('UNIV QUEVEDO','ECUADOR'),
('UNIV GUAYAGUIL','ECUADOR'),
('UNIV GUAYAQUIL','ECUADOR'),
('UNIV UNIV GUAYAQUIL','ECUADOR'),
('UNIV ESTATAL GUAYAQUIL','ECUADOR'),
('UNIV GUAYAQUIL UG','ECUADOR'),
('GUAYAQUIL UNIV','ECUADOR'),
('UNIV GUAYAQUIL ECUADOR','ECUADOR'),
('UNIVERS GUAYAQUIL','ECUADOR'),
('STATE UNIV GUAYAQUIL','ECUADOR'),
('UNIV ESTATE GUAYAQUIL','ECUADOR'),	
('UNIV GUAYAQUIL REPUBL ECUADOR','ECUADOR'),
('UNIVERSIDAD ESTATAL DE MILAGRO','ECUADOR'),
('UNIV ESTATAL MILAGROS','ECUADOR'),
('UNIV ESTATAL MILAGRO','ECUADOR'),
('STATE UNIV MILAGRO','ECUADOR'),
('UNIV ESTALAL MILAGRO UNEMI','ECUADOR'),
('UNIV ARTES ECUADOR UARTES','ECUADOR'),
('UNIV LAS ARTES UARTES','ECUADOR'),
('UNIV ARTES LAS ECUADOR','ECUADOR'),
('UNIV ARTES ECUADOR','ECUADOR'),
('UNIV ARTES GUAYAQUIL','ECUADOR'),
('UNIV TECN NORTE UTN','ECUADOR'),
('UNIV TECN NORTE','ECUADOR'),
('UNIV TECN NORTE IBARRA ECUADOR','ECUADOR'),
('UNIV TCEN NORTE','ECUADOR'),
('UNIV TECN NORTE ECUADOR','ECUADOR'),
('TECN NORTE UNIV','ECUADOR'),
('UNIV TECN NORTE','ECUADOR'),
('UNIV TECN NORTE HERBARIO NACL EUADOR','ECUADOR'),
('UNIV TECN NORTE IBARRA','ECUADOR'),
('UNIV TECNOL QUITO','ECUADOR'),
('UNIV TECN COTOPAXI UTC','ECUADOR'),
('TECH UNIV COTOPAXI UTC','ECUADOR'),
('COTOPAXI TECH UNIV UTC','ECUADOR'),
('UNIV COTOPAXI','ECUADOR'),
('UNIV TECN COTOPAXI','ECUADOR'),
('UNIV POLITECN ESTATAL CARCHI UPEC','ECUADOR'),
('UNIV POLITECN ESTATAL CARCHI','ECUADOR'),	
('UNIV POLITECN CARCHI','ECUADOR'),
('CARCHI STATE POLYTECH UNIV','ECUADOR'),
('UNIV POLITECN ESTATAL CARCHI UPEC','ECUADOR'),	
('ESCUELA SUPER POLITECN CHIMBORAZO ESPOCH','ECUADOR'),
('ESPOCH','ECUADOR'),
('CHIMBORAZO HIGHER POLYTECH SCH ESPOCH','ECUADOR'),
('CTR IDIOMAS ESPOCH','ECUADOR'),
('ESPOCH ESCUELA POLITECN CHIMBORAZO','ECUADOR'),
('ESPOCH ESCUELA SUPER POLITECN CHIMBORAZO','ECUADOR'),
('POLYTECH SCH CHIMBORAZO ESPOCH','ECUADOR'),
('POLYTECH UNIV CHIMBORAZO','ECUADOR'),
('SUPER POLITECN CHIMBORAZO','ECUADOR'),
('UNIV POLITECN SUPER CHIMBORAZO','ECUADOR'),
('POLYTECH HIGHER SCH CHIMBORAZO ESPOCH','ECUADOR'),
('ESCUELA POLITECN CHIMBORAZO','ECUADOR'),
('ESCUELA POLITECN CHIMBORAZO ESPOCH','ECUADOR'),
('ESCUELA SUPER POLITECN CHIMBORAZO','ECUADOR'),
('ESCUELA SUPER TECN CHIMBORAZO','ECUADOR'),
('ESCUELN SUPER POLITECN CHIMBORAZO','ECUADOR'),

('ESPOCH ESCUELA POLITECN CHIMBORAZO','ECUADOR'),
('HIGHER POLYTECH SCH CHIMBORAZO','ECUADOR'),
('HIGHER SUPER POLYTECH SCH CHIMBORAZO','ECUADOR'),	
('OCAS ESCUELA SUPER POLITECN CHIMBORAZO RIOBAMBA','ECUADOR'),
('POLITECN CHIMBORAZO','ECUADOR'),
('UNACH UNIV NACL CHIMBORAZO','ECUADOR'),
('UNIV NACL CHIMBORAZO','ECUADOR'),
('UNIV NATL CHIMBORAZO UNACH','ECUADOR'),
('UNIV NACL CHIMBORAZO UNACH','ECUADOR'),
('NATL UNIV CHIMBORAZO UNACH','ECUADOR'),
('UNACH UNIV NACL CHIMBORAZO','ECUADOR'),
('UNIV NATL CHIMBORAZO UNACH','ECUADOR'),
('UNIV CHIMBORAZO','ECUADOR'),
('UNIV NACL CHIMBORAZO ECUADOR','ECUADOR'),
('UNIV NACL EDUC ECUADOR','ECUADOR'),
('UNIV NACL CHIMBORAZO RIOBAMBA','ECUADOR'),
('UNIV NATL CHIMBORAZO','ECUADOR'),	
('NATL UNIV CHIMBORAZO','ECUADOR'),
('UNIV TECN CUENCA','ECUADOR'),
('UNIVERSIDAD DE CUENCA','ECUADOR'),
('UNIV CUENCA ECUADOR','ECUADOR'),
('UNIV ESTATAL CUENCA','ECUADOR'),	
('UNIV CUENCA DIUC','ECUADOR'),
('UNIV CUENCA UC','ECUADOR'),
('NIVERSIDAD CUENCA','ECUADOR'),
('RECTOR UNIV CUENCA','ECUADOR'),
('UNIV CUENCA','ECUADOR'),	
('UNIV NACL EDUC UNAE','ECUADOR'),
('UNIV NACL EDUC ECUADOR UNAE','ECUADOR'),
('UNIV NACL EDUC UNAE ECUADOR','ECUADOR'),
('NATL UNIV ECUADOR UNAE','ECUADOR'),
('NATL UNIV EDUC ECUADOR UNAE','ECUADOR'),	
('NATL UNIV EDUC UNAE','ECUADOR'),
('UNIV NACL ECUADOR UNAE','ECUADOR'),
('UNIV NACL EDUCAC','ECUADOR'),
('UNIV BOLIVAR','ECUADOR'),
('UNIV ESTATAL BOLIVAR','ECUADOR'),
('BOLIVAR STATE UNIV','ECUADOR'),
('STATE UNIV BOLIVAR','ECUADOR'),
('UNIV BOLIVAR UEB','ECUADOR'),
('UNIV STATE BOLIVAR','ECUADOR'),


    
]

# Identificar las filas que contienen las palabras clave en la columna 'affiliation'
mask_affiliation = pd.Series([False] * len(df_wos))
for word_pair in words_to_searchfinal:
    mask_affiliation |= df_wos['affiliation'].apply(lambda x: contains_words(word_pair[0], x) and contains_words(word_pair[1], x))

# Identificar las filas que contienen las palabras clave en la columna 'affiliations'
mask_affiliations = pd.Series([False] * len(df_wos))
for word_pair in words_to_searchfinal:
    mask_affiliations |= df_wos['affiliations'].apply(lambda x: contains_words(word_pair[0], x, delimiter=';') and contains_words(word_pair[1], x, delimiter=';'))

# Combinar las máscaras
mask_total = mask_affiliation | mask_affiliations

# Filtrar las filas que contienen las palabras clave
df_containstotalpublicas = df_wos[mask_total]
df_containstotalpublicas.to_excel('universidadespublicasfinales.xlsx', index=False)
# Reemplazos para realizar en las filas filtradas
replacements = {
    'UNIVERSIDAD ESTATAL DE MILAGRO':'UNIVERSIDAD ESTATAL DE MILAGRO',
    'UNIV ESTATAL MILAGROS': 'UNIVERSIDAD ESTATAL DE MILAGRO',
    'UNIV ESTATAL MILAGRO': 'UNIVERSIDAD ESTATAL DE MILAGRO',
    'STATE UNIV MILAGRO': 'UNIVERSIDAD ESTATAL DE MILAGRO',
    'UNIV ESTALAL MILAGRO UNEMI': 'UNIVERSIDAD ESTATAL DE MILAGRO',
    # ... puedes agregar más reemplazos aquí ...
}

# Aplicar los reemplazos
#df_containstotal['affiliation_modified'] = df_containstotal['affiliation_modified'].replace(replacements, regex=True)

# Eliminar filas duplicadas
#df_containstotal = df_containstotal.drop_duplicates()
#df_containstotalfinal=df_containstotal
# Guardar el resultado

